---
title: "macOS Sequoia 15.5ä¸Šã®ruby3.4ã§gem installãŒå¤±æ•—ã™ã‚‹å•é¡Œ"
emoji: "ğŸš§"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["ruby", "mac"]
published: true
---

ä¹…ã€…ã® Zenn æŠ•ç¨¿ã§ã™ã€‚
Ruby ã‚’å‹‰å¼·ã—å§‹ã‚ãŸã‚‰å•é¡Œã«é­é‡ã—ãŸãŸã‚ã€å…±æœ‰ã—ã¾ã™ã€‚

# å®Ÿéš›ã«ç™ºç”Ÿã—ãŸç’°å¢ƒ

- ç«¯æœ«: MacBook Air 13inch M3 2024
- OS: macOS Sequoia 15.5(è¡¨é¡Œã®é€šã‚Š)
- Ruby: 3.4.5
- Ruby ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£: mise 2025.6.8 macos-arm64 (2025-06-26)

# å•é¡Œ

Ruby on Rails ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†ã¨ã—ãŸã¨ã“ã‚ã€ä¸‹è¨˜ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚

```bash
> gem install rails
ERROR:  Could not find a valid gem 'rails' (>= 0), here is why:
          Unable to download data from https://rubygems.org/ - Errno::ECONNRESET: Connection reset by peer - SSL_connect (https://rubygems.org/specs.4.8.gz)
```

# è§£æ±ºç­–

ç’°å¢ƒå¤‰æ•°`RUBY_TCP_NO_FAST_FALLBACK=1`ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§è§£æ±ºã—ã¾ã—ãŸã€‚

```bash
> export RUBY_TCP_NO_FAST_FALLBACK=1
> gem install rails
Fetching zeitwerk-2.7.3.gem
Fetching thor-1.4.0.gem
# ä¸­ç•¥
Successfully installed nio4r-2.7.4
Successfully installed actioncable-8.0.2
Successfully installed rails-8.0.2
38 gems installed

A new release of RubyGems is available: 3.6.9 â†’ 3.7.1!
Run `gem update --system 3.7.1` to update your installation.
```

# åŸå› 

[issue](https://bugs.ruby-lang.org/issues/21104)ã‚’è¦‹ã‚‹é™ã‚Šã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã§ã™ã€‚

- Apple Silicon ä¸Šã® macOS 15.3 ã§ç™ºç”Ÿ
  - ãŸã ã—ã€é¡ä¼¼ã—ãŸç’°å¢ƒã§ã‚‚å†ç¾ã—ãªã„å ´åˆãŒã‚ã‚‹
- Ruby3.4 ã§å®Ÿè£…ã•ã‚ŒãŸã€Happy Eyeballs Version 2 ã«ã‚ˆã‚‹æ¥ç¶šãŒåŸå› 
  - `RUBY_TCP_NO_FAST_FALLBACK=1`ã§ Happy Eyeballs Version 2 ã‚’ç„¡åŠ¹åŒ–ã§ãã‚‹
  - æœªã (2025-08-05 æ™‚ç‚¹)æ ¹æœ¬çš„åŸå› ã¯åˆ¤æ˜ã—ã¦ã„ãªã„

# ä»Šå¾Œã®å¯¾å¿œæ¡ˆ

ã“ã®å•é¡Œã«é­é‡ã—ãŸå ´åˆã€æ ¹æœ¬è§£æ±ºã¾ã§`RUBY_TCP_NO_FAST_FALLBACK=1`ã‚’è¨­å®šã—ãŸã¾ã¾ã«ã™ã‚‹ã¨è‰¯ã•ãã†ã§ã™ã€‚
â†“zshrc ã«æ›¸ãè¾¼ã‚€å ´åˆ

```bash
echo 'export RUBY_TCP_NO_FAST_FALLBACK=1' >> ~/.zshrc
```

# å‚è€ƒæ–‡çŒ®

https://github.com/rubygems/rubygems/issues/8390
https://www.kirishikistudios.com/2025/04/08/ruby34.html
https://bugs.ruby-lang.org/issues/21104
https://www.ruby-lang.org/en/news/2024/12/25/ruby-3-4-0-released/
